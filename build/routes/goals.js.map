{"version":3,"file":"goals.js","names":["router","Router","get","req","res","ids","params","goalIds","split","Goal","findByGoalIds","result","status","json","succes","err","goals","send","post","create","body","set","_id","goal","name","message","patch","patchByGoalId","goalid","goalId","deleteByGoalId","Task","deleteMany","deletedCount"],"sources":["../../src/routes/goals.js"],"sourcesContent":["import {Router} from \"express\";\nimport {Goal} from \"../models/goal\";\nimport {Task} from \"../models/task\";\n\nconst router = Router();\n\nrouter.get(\"/:goalIds\", async (req, res) => {\n\ttry {\n\t\tconst ids = req.params.goalIds.split(\",\");\n\t\tconst result = await Goal.findByGoalIds(ids);\n\t\tif (!result) {\n\t\t\treturn res.status(404).json({succes: false, err: \"User not found\"});\n\t\t}\n\t\tres.json({goals: result});\n\t} catch (err) {\n\t\tres.status(500).send(err);\n\t}\n});\n\nrouter.post(\"/\", async (req, res) => {\n\ttry {\n\t\tconst result = await Goal.create(req.body);\n\t\tres.set({\n\t\t\t\"Content-Location\": `goals/${result._id}`,\n\t\t});\n\t\treturn res.json({goal: result});\n\t} catch (err) {\n\t\tif (err.name === \"ValidationError\") {\n\t\t\treturn res.status(400).json({succes: false, message: err.message});\n\t\t}\n\t\tres.status(500).send(err);\n\t}\n});\n\nrouter.patch(\"/:goalid\", async (req, res) => {\n\ttry {\n\t\tconst result = await Goal.patchByGoalId(req.params.goalid, req.body);\n\t\tif (!result) {\n\t\t\treturn res.status(404).json({succes: false, message: \"goal not found!\"});\n\t\t}\n\t\treturn res.json(result);\n\t} catch (err) {\n\t\tif (err.name === \"CastError\")\n\t\t\treturn res\n\t\t\t\t.status(400)\n\t\t\t\t.json({succes: false, message: \"goalId not valid for id type\"});\n\t\treturn res.status(500).json(err);\n\t}\n});\n\nrouter.delete(\"/:goalid\", async (req, res) => {\n\ttry {\n\t\tconst goalId = req.params.goalid;\n\t\tconst result = await Goal.deleteByGoalId(goalId);\n\t\tif (!result) {\n\t\t\treturn res.status(404).json({succes: false, message: \"goal not found!\"});\n\t\t}\n\t\tconst {deletedCount} = await Task.deleteMany({goal: goalId});\n\n\t\treturn res.status(200).json({\n\t\t\tsucces: true,\n\t\t\tmessage: `${deletedCount} tasks deleted successfully!`,\n\t\t});\n\t} catch (err) {\n\t\treturn res.status(500).json(err);\n\t}\n});\n\nexport default router;\n"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;+CADA,oJ;;;;;;AAGA,IAAMA,MAAM,GAAG,IAAAC,eAAA,GAAf;AAEAD,MAAM,CAACE,GAAP,CAAW,WAAX;EAAA,sEAAwB,iBAAOC,GAAP,EAAYC,GAAZ;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAEhBC,GAFgB,GAEVF,GAAG,CAACG,MAAJ,CAAWC,OAAX,CAAmBC,KAAnB,CAAyB,GAAzB,CAFU;YAAA;YAAA,OAGDC,UAAA,CAAKC,aAAL,CAAmBL,GAAnB,CAHC;;UAAA;YAGhBM,MAHgB;;YAAA,IAIjBA,MAJiB;cAAA;cAAA;YAAA;;YAAA,iCAKdP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAACC,MAAM,EAAE,KAAT;cAAgBC,GAAG,EAAE;YAArB,CAArB,CALc;;UAAA;YAOtBX,GAAG,CAACS,IAAJ,CAAS;cAACG,KAAK,EAAEL;YAAR,CAAT;YAPsB;YAAA;;UAAA;YAAA;YAAA;YAStBP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBK,IAAhB;;UATsB;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAxB;;EAAA;IAAA;EAAA;AAAA;AAaAjB,MAAM,CAACkB,IAAP,CAAY,GAAZ;EAAA,uEAAiB,kBAAOf,GAAP,EAAYC,GAAZ;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,OAEMK,UAAA,CAAKU,MAAL,CAAYhB,GAAG,CAACiB,IAAhB,CAFN;;UAAA;YAETT,MAFS;YAGfP,GAAG,CAACiB,GAAJ,CAAQ;cACP,oCAA6BV,MAAM,CAACW,GAApC;YADO,CAAR;YAHe,kCAMRlB,GAAG,CAACS,IAAJ,CAAS;cAACU,IAAI,EAAEZ;YAAP,CAAT,CANQ;;UAAA;YAAA;YAAA;;YAAA,MAQX,aAAIa,IAAJ,KAAa,iBARF;cAAA;cAAA;YAAA;;YAAA,kCASPpB,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAACC,MAAM,EAAE,KAAT;cAAgBW,OAAO,EAAE,aAAIA;YAA7B,CAArB,CATO;;UAAA;YAWfrB,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBK,IAAhB;;UAXe;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAjB;;EAAA;IAAA;EAAA;AAAA;AAeAjB,MAAM,CAAC0B,KAAP,CAAa,UAAb;EAAA,uEAAyB,kBAAOvB,GAAP,EAAYC,GAAZ;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,OAEFK,UAAA,CAAKkB,aAAL,CAAmBxB,GAAG,CAACG,MAAJ,CAAWsB,MAA9B,EAAsCzB,GAAG,CAACiB,IAA1C,CAFE;;UAAA;YAEjBT,MAFiB;;YAAA,IAGlBA,MAHkB;cAAA;cAAA;YAAA;;YAAA,kCAIfP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAACC,MAAM,EAAE,KAAT;cAAgBW,OAAO,EAAE;YAAzB,CAArB,CAJe;;UAAA;YAAA,kCAMhBrB,GAAG,CAACS,IAAJ,CAASF,MAAT,CANgB;;UAAA;YAAA;YAAA;;YAAA,MAQnB,aAAIa,IAAJ,KAAa,WARM;cAAA;cAAA;YAAA;;YAAA,kCASfpB,GAAG,CACRQ,MADK,CACE,GADF,EAELC,IAFK,CAEA;cAACC,MAAM,EAAE,KAAT;cAAgBW,OAAO,EAAE;YAAzB,CAFA,CATe;;UAAA;YAAA,kCAYhBrB,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,cAZgB;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAzB;;EAAA;IAAA;EAAA;AAAA;AAgBAb,MAAM,UAAN,CAAc,UAAd;EAAA,uEAA0B,kBAAOG,GAAP,EAAYC,GAAZ;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;YAElByB,MAFkB,GAET1B,GAAG,CAACG,MAAJ,CAAWsB,MAFF;YAAA;YAAA,OAGHnB,UAAA,CAAKqB,cAAL,CAAoBD,MAApB,CAHG;;UAAA;YAGlBlB,MAHkB;;YAAA,IAInBA,MAJmB;cAAA;cAAA;YAAA;;YAAA,kCAKhBP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAACC,MAAM,EAAE,KAAT;cAAgBW,OAAO,EAAE;YAAzB,CAArB,CALgB;;UAAA;YAAA;YAAA,OAOKM,UAAA,CAAKC,UAAL,CAAgB;cAACT,IAAI,EAAEM;YAAP,CAAhB,CAPL;;UAAA;YAAA;YAOjBI,YAPiB,yBAOjBA,YAPiB;YAAA,kCASjB7B,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAC3BC,MAAM,EAAE,IADmB;cAE3BW,OAAO,YAAKQ,YAAL;YAFoB,CAArB,CATiB;;UAAA;YAAA;YAAA;YAAA,kCAcjB7B,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,cAdiB;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAA1B;;EAAA;IAAA;EAAA;AAAA;eAkBeb,M"}